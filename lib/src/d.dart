import 'package:bidi/src/unicode_character_resolver.dart';

import 'enums.dart';

Map<int, int> charForms = {};

ArabicShapeJoiningType getArabicShapeJoiningType(int c) {
  _init();

  if (c >= 0x0600 && c <= 0x0605) return ArabicShapeJoiningType.U;
  if (c == 0x0608) return ArabicShapeJoiningType.U;
  if (c == 0x060B) return ArabicShapeJoiningType.U;
  if (c == 0x0620) return ArabicShapeJoiningType.D;
  if (c == 0x0621) return ArabicShapeJoiningType.U;
  if (c >= 0x0622 && c <= 0x0625) return ArabicShapeJoiningType.R;
  if (c == 0x0626) return ArabicShapeJoiningType.D;
  if (c == 0x0627) return ArabicShapeJoiningType.R;
  if (c == 0x0628) return ArabicShapeJoiningType.D;
  if (c == 0x0629) return ArabicShapeJoiningType.R;
  if (c >= 0x062A && c <= 0x062E) return ArabicShapeJoiningType.D;
  if (c >= 0x062F && c <= 0x0632) return ArabicShapeJoiningType.R;
  if (c >= 0x0633 && c <= 0x063F) return ArabicShapeJoiningType.D;
  if (c == 0x0640) return ArabicShapeJoiningType.C;
  if (c >= 0x0641 && c <= 0x0647) return ArabicShapeJoiningType.D;
  if (c == 0x0648) return ArabicShapeJoiningType.R;
  if (c >= 0x0649 && c <= 0x064A) return ArabicShapeJoiningType.D;
  if (c >= 0x066E && c <= 0x066F) return ArabicShapeJoiningType.D;
  if (c >= 0x0671 && c <= 0x0673) return ArabicShapeJoiningType.R;
  if (c == 0x0674) return ArabicShapeJoiningType.U;
  if (c >= 0x0675 && c <= 0x0677) return ArabicShapeJoiningType.R;
  if (c >= 0x0678 && c <= 0x0687) return ArabicShapeJoiningType.D;
  if (c >= 0x0688 && c <= 0x0699) return ArabicShapeJoiningType.R;
  if (c >= 0x069A && c <= 0x06BF) return ArabicShapeJoiningType.D;
  if (c == 0x06C0) return ArabicShapeJoiningType.R;
  if (c >= 0x06C1 && c <= 0x06C2) return ArabicShapeJoiningType.D;
  if (c >= 0x06C3 && c <= 0x06CB) return ArabicShapeJoiningType.R;
  if (c == 0x06CC) return ArabicShapeJoiningType.D;
  if (c == 0x06CD) return ArabicShapeJoiningType.R;
  if (c == 0x06CE) return ArabicShapeJoiningType.D;
  if (c == 0x06CF) return ArabicShapeJoiningType.R;
  if (c >= 0x06D0 && c <= 0x06D1) return ArabicShapeJoiningType.D;
  if (c >= 0x06D2 && c <= 0x06D3) return ArabicShapeJoiningType.R;
  if (c == 0x06D5) return ArabicShapeJoiningType.R;
  if (c == 0x06DD) return ArabicShapeJoiningType.U;
  if (c >= 0x06EE && c <= 0x06EF) return ArabicShapeJoiningType.R;
  if (c >= 0x06FA && c <= 0x06FC) return ArabicShapeJoiningType.D;
  if (c == 0x06FF) return ArabicShapeJoiningType.D;
  if (c == 0x0710) return ArabicShapeJoiningType.R;
  if (c >= 0x0712 && c <= 0x0714) return ArabicShapeJoiningType.D;
  if (c >= 0x0715 && c <= 0x0719) return ArabicShapeJoiningType.R;
  if (c >= 0x071A && c <= 0x071D) return ArabicShapeJoiningType.D;
  if (c == 0x071E) return ArabicShapeJoiningType.R;
  if (c >= 0x071F && c <= 0x0727) return ArabicShapeJoiningType.D;
  if (c == 0x0728) return ArabicShapeJoiningType.R;
  if (c == 0x0729) return ArabicShapeJoiningType.D;
  if (c == 0x072A) return ArabicShapeJoiningType.R;
  if (c == 0x072B) return ArabicShapeJoiningType.D;
  if (c == 0x072C) return ArabicShapeJoiningType.R;
  if (c >= 0x072D && c <= 0x072E) return ArabicShapeJoiningType.D;
  if (c == 0x072F) return ArabicShapeJoiningType.R;
  if (c == 0x074D) return ArabicShapeJoiningType.R;
  if (c >= 0x074E && c <= 0x0758) return ArabicShapeJoiningType.D;
  if (c >= 0x0759 && c <= 0x075B) return ArabicShapeJoiningType.R;
  if (c >= 0x075C && c <= 0x076A) return ArabicShapeJoiningType.D;
  if (c >= 0x076B && c <= 0x076C) return ArabicShapeJoiningType.R;
  if (c >= 0x076D && c <= 0x0770) return ArabicShapeJoiningType.D;
  if (c == 0x0771) return ArabicShapeJoiningType.R;
  if (c == 0x0772) return ArabicShapeJoiningType.D;
  if (c >= 0x0773 && c <= 0x0774) return ArabicShapeJoiningType.R;
  if (c >= 0x0775 && c <= 0x0777) return ArabicShapeJoiningType.D;
  if (c >= 0x0778 && c <= 0x0779) return ArabicShapeJoiningType.R;
  if (c >= 0x077A && c <= 0x077F) return ArabicShapeJoiningType.D;
  if (c >= 0x07CA && c <= 0x07EA) return ArabicShapeJoiningType.D;
  if (c == 0x07FA) return ArabicShapeJoiningType.C;
  if (c == 0x0840) return ArabicShapeJoiningType.R;
  if (c >= 0x0841 && c <= 0x0845) return ArabicShapeJoiningType.D;
  if (c == 0x0846) return ArabicShapeJoiningType.R;
  if (c >= 0x0847 && c <= 0x0848) return ArabicShapeJoiningType.D;
  if (c == 0x0849) return ArabicShapeJoiningType.R;
  if (c >= 0x084A && c <= 0x084E) return ArabicShapeJoiningType.D;
  if (c == 0x084F) return ArabicShapeJoiningType.R;
  if (c >= 0x0850 && c <= 0x0853) return ArabicShapeJoiningType.D;
  if (c == 0x0854) return ArabicShapeJoiningType.R;
  if (c == 0x0855) return ArabicShapeJoiningType.D;
  if (c >= 0x0856 && c <= 0x0858) return ArabicShapeJoiningType.U;
  if (c >= 0x08A0 && c <= 0x08A9) return ArabicShapeJoiningType.D;
  if (c >= 0x08AA && c <= 0x08AC) return ArabicShapeJoiningType.R;
  if (c == 0x08AD) return ArabicShapeJoiningType.U;
  if (c == 0x08AE) return ArabicShapeJoiningType.R;
  if (c >= 0x08AF && c <= 0x08B0) return ArabicShapeJoiningType.D;
  if (c >= 0x08B1 && c <= 0x08B2) return ArabicShapeJoiningType.R;
  if (c == 0x1806) return ArabicShapeJoiningType.U;
  if (c == 0x1807) return ArabicShapeJoiningType.D;
  if (c == 0x180A) return ArabicShapeJoiningType.C;
  if (c == 0x180E) return ArabicShapeJoiningType.U;
  if (c >= 0x1820 && c <= 0x1877) return ArabicShapeJoiningType.D;
  if (c >= 0x1880 && c <= 0x1886) return ArabicShapeJoiningType.U;
  if (c >= 0x1887 && c <= 0x18A8) return ArabicShapeJoiningType.D;
  if (c == 0x18AA) return ArabicShapeJoiningType.D;
  if (c == 0x200C) return ArabicShapeJoiningType.U;
  if (c == 0x200D) return ArabicShapeJoiningType.C;
  if (c >= 0x2066 && c <= 0x2069) return ArabicShapeJoiningType.U;
  if (c >= 0xA840 && c <= 0xA871) return ArabicShapeJoiningType.D;
  if (c == 0xA872) return ArabicShapeJoiningType.L;
  if (c == 0xA873) return ArabicShapeJoiningType.U;

  final ugc = UnicodeCharacterDataResolver.GetUnicodeGeneralCategory(c);
  if (ugc == UnicodeGeneralCategory.Mn ||
      ugc == UnicodeGeneralCategory.Me ||
      ugc == UnicodeGeneralCategory.Cf) return ArabicShapeJoiningType.T;
  return ArabicShapeJoiningType.U;
}

int getArabicCharacterByLetterForm(int ch, LetterForm form) {
  _init();

  int key = (ch) | (form.index) << 16;
  if (charForms.containsKey(key)) {
    return charForms[key];
  }
  return ch;
}

_init() {
  if (charForms.length == 0) {
    return;
  }

  charForms[0x30671] = 0xFB50;
  charForms[0x20671] = 0xFB51;
  charForms[0x3067B] = 0xFB52;
  charForms[0x2067B] = 0xFB53;
  charForms[0x0067B] = 0xFB54;
  charForms[0x1067B] = 0xFB55;
  charForms[0x3067E] = 0xFB56;
  charForms[0x2067E] = 0xFB57;
  charForms[0x0067E] = 0xFB58;
  charForms[0x1067E] = 0xFB59;
  charForms[0x30680] = 0xFB5A;
  charForms[0x20680] = 0xFB5B;
  charForms[0x00680] = 0xFB5C;
  charForms[0x10680] = 0xFB5D;
  charForms[0x3067A] = 0xFB5E;
  charForms[0x2067A] = 0xFB5F;
  charForms[0x0067A] = 0xFB60;
  charForms[0x1067A] = 0xFB61;
  charForms[0x3067F] = 0xFB62;
  charForms[0x2067F] = 0xFB63;
  charForms[0x0067F] = 0xFB64;
  charForms[0x1067F] = 0xFB65;
  charForms[0x30679] = 0xFB66;
  charForms[0x20679] = 0xFB67;
  charForms[0x00679] = 0xFB68;
  charForms[0x10679] = 0xFB69;
  charForms[0x306A4] = 0xFB6A;
  charForms[0x206A4] = 0xFB6B;
  charForms[0x006A4] = 0xFB6C;
  charForms[0x106A4] = 0xFB6D;
  charForms[0x306A6] = 0xFB6E;
  charForms[0x206A6] = 0xFB6F;
  charForms[0x006A6] = 0xFB70;
  charForms[0x106A6] = 0xFB71;
  charForms[0x30684] = 0xFB72;
  charForms[0x20684] = 0xFB73;
  charForms[0x00684] = 0xFB74;
  charForms[0x10684] = 0xFB75;
  charForms[0x30683] = 0xFB76;
  charForms[0x20683] = 0xFB77;
  charForms[0x00683] = 0xFB78;
  charForms[0x10683] = 0xFB79;
  charForms[0x30686] = 0xFB7A;
  charForms[0x20686] = 0xFB7B;
  charForms[0x00686] = 0xFB7C;
  charForms[0x10686] = 0xFB7D;
  charForms[0x30687] = 0xFB7E;
  charForms[0x20687] = 0xFB7F;
  charForms[0x00687] = 0xFB80;
  charForms[0x10687] = 0xFB81;
  charForms[0x3068D] = 0xFB82;
  charForms[0x2068D] = 0xFB83;
  charForms[0x3068C] = 0xFB84;
  charForms[0x2068C] = 0xFB85;
  charForms[0x3068E] = 0xFB86;
  charForms[0x2068E] = 0xFB87;
  charForms[0x30688] = 0xFB88;
  charForms[0x20688] = 0xFB89;
  charForms[0x30698] = 0xFB8A;
  charForms[0x20698] = 0xFB8B;
  charForms[0x30691] = 0xFB8C;
  charForms[0x20691] = 0xFB8D;
  charForms[0x306A9] = 0xFB8E;
  charForms[0x206A9] = 0xFB8F;
  charForms[0x006A9] = 0xFB90;
  charForms[0x106A9] = 0xFB91;
  charForms[0x306AF] = 0xFB92;
  charForms[0x206AF] = 0xFB93;
  charForms[0x006AF] = 0xFB94;
  charForms[0x106AF] = 0xFB95;
  charForms[0x306B3] = 0xFB96;
  charForms[0x206B3] = 0xFB97;
  charForms[0x006B3] = 0xFB98;
  charForms[0x106B3] = 0xFB99;
  charForms[0x306B1] = 0xFB9A;
  charForms[0x206B1] = 0xFB9B;
  charForms[0x006B1] = 0xFB9C;
  charForms[0x106B1] = 0xFB9D;
  charForms[0x306BA] = 0xFB9E;
  charForms[0x206BA] = 0xFB9F;
  charForms[0x306BB] = 0xFBA0;
  charForms[0x206BB] = 0xFBA1;
  charForms[0x006BB] = 0xFBA2;
  charForms[0x106BB] = 0xFBA3;
  charForms[0x306C0] = 0xFBA4;
  charForms[0x206C0] = 0xFBA5;
  charForms[0x306C1] = 0xFBA6;
  charForms[0x206C1] = 0xFBA7;
  charForms[0x006C1] = 0xFBA8;
  charForms[0x106C1] = 0xFBA9;
  charForms[0x306BE] = 0xFBAA;
  charForms[0x206BE] = 0xFBAB;
  charForms[0x006BE] = 0xFBAC;
  charForms[0x106BE] = 0xFBAD;
  charForms[0x306D2] = 0xFBAE;
  charForms[0x206D2] = 0xFBAF;
  charForms[0x306D3] = 0xFBB0;
  charForms[0x206D3] = 0xFBB1;
  charForms[0x306AD] = 0xFBD3;
  charForms[0x206AD] = 0xFBD4;
  charForms[0x006AD] = 0xFBD5;
  charForms[0x106AD] = 0xFBD6;
  charForms[0x306C7] = 0xFBD7;
  charForms[0x206C7] = 0xFBD8;
  charForms[0x306C6] = 0xFBD9;
  charForms[0x206C6] = 0xFBDA;
  charForms[0x306C8] = 0xFBDB;
  charForms[0x206C8] = 0xFBDC;
  charForms[0x30677] = 0xFBDD;
  charForms[0x306CB] = 0xFBDE;
  charForms[0x206CB] = 0xFBDF;
  charForms[0x306C5] = 0xFBE0;
  charForms[0x206C5] = 0xFBE1;
  charForms[0x306C9] = 0xFBE2;
  charForms[0x206C9] = 0xFBE3;
  charForms[0x306D0] = 0xFBE4;
  charForms[0x206D0] = 0xFBE5;
  charForms[0x006D0] = 0xFBE6;
  charForms[0x106D0] = 0xFBE7;
  charForms[0x00649] = 0xFBE8;
  charForms[0x10649] = 0xFBE9;
  charForms[0x306CC] = 0xFBFC;
  charForms[0x206CC] = 0xFBFD;
  charForms[0x006CC] = 0xFBFE;
  charForms[0x106CC] = 0xFBFF;
  charForms[0x30621] = 0xFE80;
  charForms[0x30622] = 0xFE81;
  charForms[0x20622] = 0xFE82;
  charForms[0x30623] = 0xFE83;
  charForms[0x20623] = 0xFE84;
  charForms[0x30624] = 0xFE85;
  charForms[0x20624] = 0xFE86;
  charForms[0x30625] = 0xFE87;
  charForms[0x20625] = 0xFE88;
  charForms[0x30626] = 0xFE89;
  charForms[0x20626] = 0xFE8A;
  charForms[0x00626] = 0xFE8B;
  charForms[0x10626] = 0xFE8C;
  charForms[0x30627] = 0xFE8D;
  charForms[0x20627] = 0xFE8E;
  charForms[0x30628] = 0xFE8F;
  charForms[0x20628] = 0xFE90;
  charForms[0x00628] = 0xFE91;
  charForms[0x10628] = 0xFE92;
  charForms[0x30629] = 0xFE93;
  charForms[0x20629] = 0xFE94;
  charForms[0x3062A] = 0xFE95;
  charForms[0x2062A] = 0xFE96;
  charForms[0x0062A] = 0xFE97;
  charForms[0x1062A] = 0xFE98;
  charForms[0x3062B] = 0xFE99;
  charForms[0x2062B] = 0xFE9A;
  charForms[0x0062B] = 0xFE9B;
  charForms[0x1062B] = 0xFE9C;
  charForms[0x3062C] = 0xFE9D;
  charForms[0x2062C] = 0xFE9E;
  charForms[0x0062C] = 0xFE9F;
  charForms[0x1062C] = 0xFEA0;
  charForms[0x3062D] = 0xFEA1;
  charForms[0x2062D] = 0xFEA2;
  charForms[0x0062D] = 0xFEA3;
  charForms[0x1062D] = 0xFEA4;
  charForms[0x3062E] = 0xFEA5;
  charForms[0x2062E] = 0xFEA6;
  charForms[0x0062E] = 0xFEA7;
  charForms[0x1062E] = 0xFEA8;
  charForms[0x3062F] = 0xFEA9;
  charForms[0x2062F] = 0xFEAA;
  charForms[0x30630] = 0xFEAB;
  charForms[0x20630] = 0xFEAC;
  charForms[0x30631] = 0xFEAD;
  charForms[0x20631] = 0xFEAE;
  charForms[0x30632] = 0xFEAF;
  charForms[0x20632] = 0xFEB0;
  charForms[0x30633] = 0xFEB1;
  charForms[0x20633] = 0xFEB2;
  charForms[0x00633] = 0xFEB3;
  charForms[0x10633] = 0xFEB4;
  charForms[0x30634] = 0xFEB5;
  charForms[0x20634] = 0xFEB6;
  charForms[0x00634] = 0xFEB7;
  charForms[0x10634] = 0xFEB8;
  charForms[0x30635] = 0xFEB9;
  charForms[0x20635] = 0xFEBA;
  charForms[0x00635] = 0xFEBB;
  charForms[0x10635] = 0xFEBC;
  charForms[0x30636] = 0xFEBD;
  charForms[0x20636] = 0xFEBE;
  charForms[0x00636] = 0xFEBF;
  charForms[0x10636] = 0xFEC0;
  charForms[0x30637] = 0xFEC1;
  charForms[0x20637] = 0xFEC2;
  charForms[0x00637] = 0xFEC3;
  charForms[0x10637] = 0xFEC4;
  charForms[0x30638] = 0xFEC5;
  charForms[0x20638] = 0xFEC6;
  charForms[0x00638] = 0xFEC7;
  charForms[0x10638] = 0xFEC8;
  charForms[0x30639] = 0xFEC9;
  charForms[0x20639] = 0xFECA;
  charForms[0x00639] = 0xFECB;
  charForms[0x10639] = 0xFECC;
  charForms[0x3063A] = 0xFECD;
  charForms[0x2063A] = 0xFECE;
  charForms[0x0063A] = 0xFECF;
  charForms[0x1063A] = 0xFED0;
  charForms[0x30641] = 0xFED1;
  charForms[0x20641] = 0xFED2;
  charForms[0x00641] = 0xFED3;
  charForms[0x10641] = 0xFED4;
  charForms[0x30642] = 0xFED5;
  charForms[0x20642] = 0xFED6;
  charForms[0x00642] = 0xFED7;
  charForms[0x10642] = 0xFED8;
  charForms[0x30643] = 0xFED9;
  charForms[0x20643] = 0xFEDA;
  charForms[0x00643] = 0xFEDB;
  charForms[0x10643] = 0xFEDC;
  charForms[0x30644] = 0xFEDD;
  charForms[0x20644] = 0xFEDE;
  charForms[0x00644] = 0xFEDF;
  charForms[0x10644] = 0xFEE0;
  charForms[0x30645] = 0xFEE1;
  charForms[0x20645] = 0xFEE2;
  charForms[0x00645] = 0xFEE3;
  charForms[0x10645] = 0xFEE4;
  charForms[0x30646] = 0xFEE5;
  charForms[0x20646] = 0xFEE6;
  charForms[0x00646] = 0xFEE7;
  charForms[0x10646] = 0xFEE8;
  charForms[0x30647] = 0xFEE9;
  charForms[0x20647] = 0xFEEA;
  charForms[0x00647] = 0xFEEB;
  charForms[0x10647] = 0xFEEC;
  charForms[0x30648] = 0xFEED;
  charForms[0x20648] = 0xFEEE;
  charForms[0x30649] = 0xFEEF;
  charForms[0x20649] = 0xFEF0;
  charForms[0x3064A] = 0xFEF1;
  charForms[0x2064A] = 0xFEF2;
  charForms[0x0064A] = 0xFEF3;
  charForms[0x1064A] = 0xFEF4;
}
